/*
 * fftlib.c
 *
 *  Created on: Nov 25, 2017
 *      Author: esdev
 */

#include <stdlib.h>
#include "fftlib.h"

#define	BITS	7
#define	SIZE	128

// singleton data members
static const double real_roots[SIZE] = {1.0, 0.99998118, 0.9999247, 0.99983058, 0.99969882, 0.99952942, 0.99932238, 0.99907773, 0.99879546, 0.99847558, 0.99811811, 0.99772307, 0.99729046, 0.9968203, 0.99631261, 0.99576741, 0.99518473, 0.99456457, 0.99390697, 0.99321195, 0.99247953, 0.99170975, 0.99090264, 0.99005821, 0.98917651, 0.98825757, 0.98730142, 0.9863081, 0.98527764, 0.98421009, 0.98310549, 0.98196387, 0.98078528, 0.97956977, 0.97831737, 0.97702814, 0.97570213, 0.97433938, 0.97293995, 0.97150389, 0.97003125, 0.96852209, 0.96697647, 0.96539444, 0.96377607, 0.9621214, 0.96043052, 0.95870347, 0.95694034, 0.95514117, 0.95330604, 0.95143502, 0.94952818, 0.94758559, 0.94560733, 0.94359346, 0.94154407, 0.93945922, 0.93733901, 0.93518351, 0.9329928, 0.93076696, 0.92850608, 0.92621024, 0.92387953, 0.92151404, 0.91911385, 0.91667906, 0.91420976, 0.91170603, 0.90916798, 0.9065957, 0.90398929, 0.90134885, 0.89867447, 0.89596625, 0.8932243, 0.89044872, 0.88763962, 0.8847971, 0.88192126, 0.87901223, 0.87607009, 0.87309498, 0.87008699, 0.86704625, 0.86397286, 0.86086694, 0.85772861, 0.85455799, 0.85135519, 0.84812034, 0.84485357, 0.84155498, 0.83822471, 0.83486287, 0.83146961, 0.82804505, 0.8245893, 0.82110251, 0.81758481, 0.81403633, 0.8104572, 0.80684755, 0.80320753, 0.79953727, 0.7958369, 0.79210658, 0.78834643, 0.7845566, 0.78073723, 0.77688847, 0.77301045, 0.76910334, 0.76516727, 0.76120239, 0.75720885, 0.7531868, 0.74913639, 0.74505779, 0.74095113, 0.73681657, 0.73265427, 0.72846439, 0.72424708, 0.72000251, 0.71573083, 0.7114322, 0.70710678, 0.70275474, 0.69837625, 0.69397146, 0.68954054, 0.68508367, 0.680601, 0.6760927, 0.67155895, 0.66699992, 0.66241578, 0.65780669, 0.65317284, 0.6485144, 0.64383154, 0.63912444, 0.63439328, 0.62963824, 0.62485949, 0.62005721, 0.61523159, 0.61038281, 0.60551104, 0.60061648, 0.5956993, 0.5907597, 0.58579786, 0.58081396, 0.57580819, 0.57078075, 0.56573181, 0.56066158, 0.55557023, 0.55045797, 0.54532499, 0.54017147, 0.53499762, 0.52980362, 0.52458968, 0.51935599, 0.51410274, 0.50883014, 0.50353838, 0.49822767, 0.49289819, 0.48755016, 0.48218377, 0.47679923, 0.47139674, 0.4659765, 0.46053871, 0.45508359, 0.44961133, 0.44412214, 0.43861624, 0.43309382, 0.42755509, 0.42200027, 0.41642956, 0.41084317, 0.40524131, 0.3996242, 0.39399204, 0.38834505, 0.38268343, 0.37700741, 0.37131719, 0.365613, 0.35989504, 0.35416353, 0.34841868, 0.34266072, 0.33688985, 0.33110631, 0.32531029, 0.31950203, 0.31368174, 0.30784964, 0.30200595, 0.29615089, 0.29028468, 0.28440754, 0.27851969, 0.27262136, 0.26671276, 0.26079412, 0.25486566, 0.24892761, 0.24298018, 0.23702361, 0.23105811, 0.22508391, 0.21910124, 0.21311032, 0.20711138, 0.20110463, 0.19509032, 0.18906866, 0.18303989, 0.17700422, 0.17096189, 0.16491312, 0.15885814, 0.15279719, 0.14673047, 0.14065824, 0.13458071, 0.12849811, 0.12241068, 0.11631863, 0.11022221, 0.10412163, 0.09801714, 0.09190896, 0.08579731, 0.07968244, 0.07356456, 0.06744392, 0.06132074, 0.05519524, 0.04906767, 0.04293826, 0.03680722, 0.0306748, 0.02454123, 0.01840673, 0.01227154, 0.00613588, 0.0, -0.00613588, -0.01227154, -0.01840673, -0.02454123, -0.0306748, -0.03680722, -0.04293826, -0.04906767, -0.05519524, -0.06132074, -0.06744392, -0.07356456, -0.07968244, -0.08579731, -0.09190896, -0.09801714, -0.10412163, -0.11022221, -0.11631863, -0.12241068, -0.12849811, -0.13458071, -0.14065824, -0.14673047, -0.15279719, -0.15885814, -0.16491312, -0.17096189, -0.17700422, -0.18303989, -0.18906866, -0.19509032, -0.20110463, -0.20711138, -0.21311032, -0.21910124, -0.22508391, -0.23105811, -0.23702361, -0.24298018, -0.24892761, -0.25486566, -0.26079412, -0.26671276, -0.27262136, -0.27851969, -0.28440754, -0.29028468, -0.29615089, -0.30200595, -0.30784964, -0.31368174, -0.31950203, -0.32531029, -0.33110631, -0.33688985, -0.34266072, -0.34841868, -0.35416353, -0.35989504, -0.365613, -0.37131719, -0.37700741, -0.38268343, -0.38834505, -0.39399204, -0.3996242, -0.40524131, -0.41084317, -0.41642956, -0.42200027, -0.42755509, -0.43309382, -0.43861624, -0.44412214, -0.44961133, -0.45508359, -0.46053871, -0.4659765, -0.47139674, -0.47679923, -0.48218377, -0.48755016, -0.49289819, -0.49822767, -0.50353838, -0.50883014, -0.51410274, -0.51935599, -0.52458968, -0.52980362, -0.53499762, -0.54017147, -0.54532499, -0.55045797, -0.55557023, -0.56066158, -0.56573181, -0.57078075, -0.57580819, -0.58081396, -0.58579786, -0.5907597, -0.5956993, -0.60061648, -0.60551104, -0.61038281, -0.61523159, -0.62005721, -0.62485949, -0.62963824, -0.63439328, -0.63912444, -0.64383154, -0.6485144, -0.65317284, -0.65780669, -0.66241578, -0.66699992, -0.67155895, -0.6760927, -0.680601, -0.68508367, -0.68954054, -0.69397146, -0.69837625, -0.70275474, -0.70710678, -0.7114322, -0.71573083, -0.72000251, -0.72424708, -0.72846439, -0.73265427, -0.73681657, -0.74095113, -0.74505779, -0.74913639, -0.7531868, -0.75720885, -0.76120239, -0.76516727, -0.76910334, -0.77301045, -0.77688847, -0.78073723, -0.7845566, -0.78834643, -0.79210658, -0.7958369, -0.79953727, -0.80320753, -0.80684755, -0.8104572, -0.81403633, -0.81758481, -0.82110251, -0.8245893, -0.82804505, -0.83146961, -0.83486287, -0.83822471, -0.84155498, -0.84485357, -0.84812034, -0.85135519, -0.85455799, -0.85772861, -0.86086694, -0.86397286, -0.86704625, -0.87008699, -0.87309498, -0.87607009, -0.87901223, -0.88192126, -0.8847971, -0.88763962, -0.89044872, -0.8932243, -0.89596625, -0.89867447, -0.90134885, -0.90398929, -0.9065957, -0.90916798, -0.91170603, -0.91420976, -0.91667906, -0.91911385, -0.92151404, -0.92387953, -0.92621024, -0.92850608, -0.93076696, -0.9329928, -0.93518351, -0.93733901, -0.93945922, -0.94154407, -0.94359346, -0.94560733, -0.94758559, -0.94952818, -0.95143502, -0.95330604, -0.95514117, -0.95694034, -0.95870347, -0.96043052, -0.9621214, -0.96377607, -0.96539444, -0.96697647, -0.96852209, -0.97003125, -0.97150389, -0.97293995, -0.97433938, -0.97570213, -0.97702814, -0.97831737, -0.97956977, -0.98078528, -0.98196387, -0.98310549, -0.98421009, -0.98527764, -0.9863081, -0.98730142, -0.98825757, -0.98917651, -0.99005821, -0.99090264, -0.99170975, -0.99247953, -0.99321195, -0.99390697, -0.99456457, -0.99518473, -0.99576741, -0.99631261, -0.9968203, -0.99729046, -0.99772307, -0.99811811, -0.99847558, -0.99879546, -0.99907773, -0.99932238, -0.99952942, -0.99969882, -0.99983058, -0.9999247, -0.99998118, -1.0, -0.99998118, -0.9999247, -0.99983058, -0.99969882, -0.99952942, -0.99932238, -0.99907773, -0.99879546, -0.99847558, -0.99811811, -0.99772307, -0.99729046, -0.9968203, -0.99631261, -0.99576741, -0.99518473, -0.99456457, -0.99390697, -0.99321195, -0.99247953, -0.99170975, -0.99090264, -0.99005821, -0.98917651, -0.98825757, -0.98730142, -0.9863081, -0.98527764, -0.98421009, -0.98310549, -0.98196387, -0.98078528, -0.97956977, -0.97831737, -0.97702814, -0.97570213, -0.97433938, -0.97293995, -0.97150389, -0.97003125, -0.96852209, -0.96697647, -0.96539444, -0.96377607, -0.9621214, -0.96043052, -0.95870347, -0.95694034, -0.95514117, -0.95330604, -0.95143502, -0.94952818, -0.94758559, -0.94560733, -0.94359346, -0.94154407, -0.93945922, -0.93733901, -0.93518351, -0.9329928, -0.93076696, -0.92850608, -0.92621024, -0.92387953, -0.92151404, -0.91911385, -0.91667906, -0.91420976, -0.91170603, -0.90916798, -0.9065957, -0.90398929, -0.90134885, -0.89867447, -0.89596625, -0.8932243, -0.89044872, -0.88763962, -0.8847971, -0.88192126, -0.87901223, -0.87607009, -0.87309498, -0.87008699, -0.86704625, -0.86397286, -0.86086694, -0.85772861, -0.85455799, -0.85135519, -0.84812034, -0.84485357, -0.84155498, -0.83822471, -0.83486287, -0.83146961, -0.82804505, -0.8245893, -0.82110251, -0.81758481, -0.81403633, -0.8104572, -0.80684755, -0.80320753, -0.79953727, -0.7958369, -0.79210658, -0.78834643, -0.7845566, -0.78073723, -0.77688847, -0.77301045, -0.76910334, -0.76516727, -0.76120239, -0.75720885, -0.7531868, -0.74913639, -0.74505779, -0.74095113, -0.73681657, -0.73265427, -0.72846439, -0.72424708, -0.72000251, -0.71573083, -0.7114322, -0.70710678, -0.70275474, -0.69837625, -0.69397146, -0.68954054, -0.68508367, -0.680601, -0.6760927, -0.67155895, -0.66699992, -0.66241578, -0.65780669, -0.65317284, -0.6485144, -0.64383154, -0.63912444, -0.63439328, -0.62963824, -0.62485949, -0.62005721, -0.61523159, -0.61038281, -0.60551104, -0.60061648, -0.5956993, -0.5907597, -0.58579786, -0.58081396, -0.57580819, -0.57078075, -0.56573181, -0.56066158, -0.55557023, -0.55045797, -0.54532499, -0.54017147, -0.53499762, -0.52980362, -0.52458968, -0.51935599, -0.51410274, -0.50883014, -0.50353838, -0.49822767, -0.49289819, -0.48755016, -0.48218377, -0.47679923, -0.47139674, -0.4659765, -0.46053871, -0.45508359, -0.44961133, -0.44412214, -0.43861624, -0.43309382, -0.42755509, -0.42200027, -0.41642956, -0.41084317, -0.40524131, -0.3996242, -0.39399204, -0.38834505, -0.38268343, -0.37700741, -0.37131719, -0.365613, -0.35989504, -0.35416353, -0.34841868, -0.34266072, -0.33688985, -0.33110631, -0.32531029, -0.31950203, -0.31368174, -0.30784964, -0.30200595, -0.29615089, -0.29028468, -0.28440754, -0.27851969, -0.27262136, -0.26671276, -0.26079412, -0.25486566, -0.24892761, -0.24298018, -0.23702361, -0.23105811, -0.22508391, -0.21910124, -0.21311032, -0.20711138, -0.20110463, -0.19509032, -0.18906866, -0.18303989, -0.17700422, -0.17096189, -0.16491312, -0.15885814, -0.15279719, -0.14673047, -0.14065824, -0.13458071, -0.12849811, -0.12241068, -0.11631863, -0.11022221, -0.10412163, -0.09801714, -0.09190896, -0.08579731, -0.07968244, -0.07356456, -0.06744392, -0.06132074, -0.05519524, -0.04906767, -0.04293826, -0.03680722, -0.0306748, -0.02454123, -0.01840673, -0.01227154, -0.00613588, -0.0, 0.00613588, 0.01227154, 0.01840673, 0.02454123, 0.0306748, 0.03680722, 0.04293826, 0.04906767, 0.05519524, 0.06132074, 0.06744392, 0.07356456, 0.07968244, 0.08579731, 0.09190896, 0.09801714, 0.10412163, 0.11022221, 0.11631863, 0.12241068, 0.12849811, 0.13458071, 0.14065824, 0.14673047, 0.15279719, 0.15885814, 0.16491312, 0.17096189, 0.17700422, 0.18303989, 0.18906866, 0.19509032, 0.20110463, 0.20711138, 0.21311032, 0.21910124, 0.22508391, 0.23105811, 0.23702361, 0.24298018, 0.24892761, 0.25486566, 0.26079412, 0.26671276, 0.27262136, 0.27851969, 0.28440754, 0.29028468, 0.29615089, 0.30200595, 0.30784964, 0.31368174, 0.31950203, 0.32531029, 0.33110631, 0.33688985, 0.34266072, 0.34841868, 0.35416353, 0.35989504, 0.365613, 0.37131719, 0.37700741, 0.38268343, 0.38834505, 0.39399204, 0.3996242, 0.40524131, 0.41084317, 0.41642956, 0.42200027, 0.42755509, 0.43309382, 0.43861624, 0.44412214, 0.44961133, 0.45508359, 0.46053871, 0.4659765, 0.47139674, 0.47679923, 0.48218377, 0.48755016, 0.49289819, 0.49822767, 0.50353838, 0.50883014, 0.51410274, 0.51935599, 0.52458968, 0.52980362, 0.53499762, 0.54017147, 0.54532499, 0.55045797, 0.55557023, 0.56066158, 0.56573181, 0.57078075, 0.57580819, 0.58081396, 0.58579786, 0.5907597, 0.5956993, 0.60061648, 0.60551104, 0.61038281, 0.61523159, 0.62005721, 0.62485949, 0.62963824, 0.63439328, 0.63912444, 0.64383154, 0.6485144, 0.65317284, 0.65780669, 0.66241578, 0.66699992, 0.67155895, 0.6760927, 0.680601, 0.68508367, 0.68954054, 0.69397146, 0.69837625, 0.70275474, 0.70710678, 0.7114322, 0.71573083, 0.72000251, 0.72424708, 0.72846439, 0.73265427, 0.73681657, 0.74095113, 0.74505779, 0.74913639, 0.7531868, 0.75720885, 0.76120239, 0.76516727, 0.76910334, 0.77301045, 0.77688847, 0.78073723, 0.7845566, 0.78834643, 0.79210658, 0.7958369, 0.79953727, 0.80320753, 0.80684755, 0.8104572, 0.81403633, 0.81758481, 0.82110251, 0.8245893, 0.82804505, 0.83146961, 0.83486287, 0.83822471, 0.84155498, 0.84485357, 0.84812034, 0.85135519, 0.85455799, 0.85772861, 0.86086694, 0.86397286, 0.86704625, 0.87008699, 0.87309498, 0.87607009, 0.87901223, 0.88192126, 0.8847971, 0.88763962, 0.89044872, 0.8932243, 0.89596625, 0.89867447, 0.90134885, 0.90398929, 0.9065957, 0.90916798, 0.91170603, 0.91420976, 0.91667906, 0.91911385, 0.92151404, 0.92387953, 0.92621024, 0.92850608, 0.93076696, 0.9329928, 0.93518351, 0.93733901, 0.93945922, 0.94154407, 0.94359346, 0.94560733, 0.94758559, 0.94952818, 0.95143502, 0.95330604, 0.95514117, 0.95694034, 0.95870347, 0.96043052, 0.9621214, 0.96377607, 0.96539444, 0.96697647, 0.96852209, 0.97003125, 0.97150389, 0.97293995, 0.97433938, 0.97570213, 0.97702814, 0.97831737, 0.97956977, 0.98078528, 0.98196387, 0.98310549, 0.98421009, 0.98527764, 0.9863081, 0.98730142, 0.98825757, 0.98917651, 0.99005821, 0.99090264, 0.99170975, 0.99247953, 0.99321195, 0.99390697, 0.99456457, 0.99518473, 0.99576741, 0.99631261, 0.9968203, 0.99729046, 0.99772307, 0.99811811, 0.99847558, 0.99879546, 0.99907773, 0.99932238, 0.99952942, 0.99969882, 0.99983058, 0.9999247, 0.99998118};
static const double imag_roots[SIZE] = {0.0, 0.00613588, 0.01227154, 0.01840673, 0.02454123, 0.0306748, 0.03680722, 0.04293826, 0.04906767, 0.05519524, 0.06132074, 0.06744392, 0.07356456, 0.07968244, 0.08579731, 0.09190896, 0.09801714, 0.10412163, 0.11022221, 0.11631863, 0.12241068, 0.12849811, 0.13458071, 0.14065824, 0.14673047, 0.15279719, 0.15885814, 0.16491312, 0.17096189, 0.17700422, 0.18303989, 0.18906866, 0.19509032, 0.20110463, 0.20711138, 0.21311032, 0.21910124, 0.22508391, 0.23105811, 0.23702361, 0.24298018, 0.24892761, 0.25486566, 0.26079412, 0.26671276, 0.27262136, 0.27851969, 0.28440754, 0.29028468, 0.29615089, 0.30200595, 0.30784964, 0.31368174, 0.31950203, 0.32531029, 0.33110631, 0.33688985, 0.34266072, 0.34841868, 0.35416353, 0.35989504, 0.365613, 0.37131719, 0.37700741, 0.38268343, 0.38834505, 0.39399204, 0.3996242, 0.40524131, 0.41084317, 0.41642956, 0.42200027, 0.42755509, 0.43309382, 0.43861624, 0.44412214, 0.44961133, 0.45508359, 0.46053871, 0.4659765, 0.47139674, 0.47679923, 0.48218377, 0.48755016, 0.49289819, 0.49822767, 0.50353838, 0.50883014, 0.51410274, 0.51935599, 0.52458968, 0.52980362, 0.53499762, 0.54017147, 0.54532499, 0.55045797, 0.55557023, 0.56066158, 0.56573181, 0.57078075, 0.57580819, 0.58081396, 0.58579786, 0.5907597, 0.5956993, 0.60061648, 0.60551104, 0.61038281, 0.61523159, 0.62005721, 0.62485949, 0.62963824, 0.63439328, 0.63912444, 0.64383154, 0.6485144, 0.65317284, 0.65780669, 0.66241578, 0.66699992, 0.67155895, 0.6760927, 0.680601, 0.68508367, 0.68954054, 0.69397146, 0.69837625, 0.70275474, 0.70710678, 0.7114322, 0.71573083, 0.72000251, 0.72424708, 0.72846439, 0.73265427, 0.73681657, 0.74095113, 0.74505779, 0.74913639, 0.7531868, 0.75720885, 0.76120239, 0.76516727, 0.76910334, 0.77301045, 0.77688847, 0.78073723, 0.7845566, 0.78834643, 0.79210658, 0.7958369, 0.79953727, 0.80320753, 0.80684755, 0.8104572, 0.81403633, 0.81758481, 0.82110251, 0.8245893, 0.82804505, 0.83146961, 0.83486287, 0.83822471, 0.84155498, 0.84485357, 0.84812034, 0.85135519, 0.85455799, 0.85772861, 0.86086694, 0.86397286, 0.86704625, 0.87008699, 0.87309498, 0.87607009, 0.87901223, 0.88192126, 0.8847971, 0.88763962, 0.89044872, 0.8932243, 0.89596625, 0.89867447, 0.90134885, 0.90398929, 0.9065957, 0.90916798, 0.91170603, 0.91420976, 0.91667906, 0.91911385, 0.92151404, 0.92387953, 0.92621024, 0.92850608, 0.93076696, 0.9329928, 0.93518351, 0.93733901, 0.93945922, 0.94154407, 0.94359346, 0.94560733, 0.94758559, 0.94952818, 0.95143502, 0.95330604, 0.95514117, 0.95694034, 0.95870347, 0.96043052, 0.9621214, 0.96377607, 0.96539444, 0.96697647, 0.96852209, 0.97003125, 0.97150389, 0.97293995, 0.97433938, 0.97570213, 0.97702814, 0.97831737, 0.97956977, 0.98078528, 0.98196387, 0.98310549, 0.98421009, 0.98527764, 0.9863081, 0.98730142, 0.98825757, 0.98917651, 0.99005821, 0.99090264, 0.99170975, 0.99247953, 0.99321195, 0.99390697, 0.99456457, 0.99518473, 0.99576741, 0.99631261, 0.9968203, 0.99729046, 0.99772307, 0.99811811, 0.99847558, 0.99879546, 0.99907773, 0.99932238, 0.99952942, 0.99969882, 0.99983058, 0.9999247, 0.99998118, 1.0, 0.99998118, 0.9999247, 0.99983058, 0.99969882, 0.99952942, 0.99932238, 0.99907773, 0.99879546, 0.99847558, 0.99811811, 0.99772307, 0.99729046, 0.9968203, 0.99631261, 0.99576741, 0.99518473, 0.99456457, 0.99390697, 0.99321195, 0.99247953, 0.99170975, 0.99090264, 0.99005821, 0.98917651, 0.98825757, 0.98730142, 0.9863081, 0.98527764, 0.98421009, 0.98310549, 0.98196387, 0.98078528, 0.97956977, 0.97831737, 0.97702814, 0.97570213, 0.97433938, 0.97293995, 0.97150389, 0.97003125, 0.96852209, 0.96697647, 0.96539444, 0.96377607, 0.9621214, 0.96043052, 0.95870347, 0.95694034, 0.95514117, 0.95330604, 0.95143502, 0.94952818, 0.94758559, 0.94560733, 0.94359346, 0.94154407, 0.93945922, 0.93733901, 0.93518351, 0.9329928, 0.93076696, 0.92850608, 0.92621024, 0.92387953, 0.92151404, 0.91911385, 0.91667906, 0.91420976, 0.91170603, 0.90916798, 0.9065957, 0.90398929, 0.90134885, 0.89867447, 0.89596625, 0.8932243, 0.89044872, 0.88763962, 0.8847971, 0.88192126, 0.87901223, 0.87607009, 0.87309498, 0.87008699, 0.86704625, 0.86397286, 0.86086694, 0.85772861, 0.85455799, 0.85135519, 0.84812034, 0.84485357, 0.84155498, 0.83822471, 0.83486287, 0.83146961, 0.82804505, 0.8245893, 0.82110251, 0.81758481, 0.81403633, 0.8104572, 0.80684755, 0.80320753, 0.79953727, 0.7958369, 0.79210658, 0.78834643, 0.7845566, 0.78073723, 0.77688847, 0.77301045, 0.76910334, 0.76516727, 0.76120239, 0.75720885, 0.7531868, 0.74913639, 0.74505779, 0.74095113, 0.73681657, 0.73265427, 0.72846439, 0.72424708, 0.72000251, 0.71573083, 0.7114322, 0.70710678, 0.70275474, 0.69837625, 0.69397146, 0.68954054, 0.68508367, 0.680601, 0.6760927, 0.67155895, 0.66699992, 0.66241578, 0.65780669, 0.65317284, 0.6485144, 0.64383154, 0.63912444, 0.63439328, 0.62963824, 0.62485949, 0.62005721, 0.61523159, 0.61038281, 0.60551104, 0.60061648, 0.5956993, 0.5907597, 0.58579786, 0.58081396, 0.57580819, 0.57078075, 0.56573181, 0.56066158, 0.55557023, 0.55045797, 0.54532499, 0.54017147, 0.53499762, 0.52980362, 0.52458968, 0.51935599, 0.51410274, 0.50883014, 0.50353838, 0.49822767, 0.49289819, 0.48755016, 0.48218377, 0.47679923, 0.47139674, 0.4659765, 0.46053871, 0.45508359, 0.44961133, 0.44412214, 0.43861624, 0.43309382, 0.42755509, 0.42200027, 0.41642956, 0.41084317, 0.40524131, 0.3996242, 0.39399204, 0.38834505, 0.38268343, 0.37700741, 0.37131719, 0.365613, 0.35989504, 0.35416353, 0.34841868, 0.34266072, 0.33688985, 0.33110631, 0.32531029, 0.31950203, 0.31368174, 0.30784964, 0.30200595, 0.29615089, 0.29028468, 0.28440754, 0.27851969, 0.27262136, 0.26671276, 0.26079412, 0.25486566, 0.24892761, 0.24298018, 0.23702361, 0.23105811, 0.22508391, 0.21910124, 0.21311032, 0.20711138, 0.20110463, 0.19509032, 0.18906866, 0.18303989, 0.17700422, 0.17096189, 0.16491312, 0.15885814, 0.15279719, 0.14673047, 0.14065824, 0.13458071, 0.12849811, 0.12241068, 0.11631863, 0.11022221, 0.10412163, 0.09801714, 0.09190896, 0.08579731, 0.07968244, 0.07356456, 0.06744392, 0.06132074, 0.05519524, 0.04906767, 0.04293826, 0.03680722, 0.0306748, 0.02454123, 0.01840673, 0.01227154, 0.00613588, 0.0, -0.00613588, -0.01227154, -0.01840673, -0.02454123, -0.0306748, -0.03680722, -0.04293826, -0.04906767, -0.05519524, -0.06132074, -0.06744392, -0.07356456, -0.07968244, -0.08579731, -0.09190896, -0.09801714, -0.10412163, -0.11022221, -0.11631863, -0.12241068, -0.12849811, -0.13458071, -0.14065824, -0.14673047, -0.15279719, -0.15885814, -0.16491312, -0.17096189, -0.17700422, -0.18303989, -0.18906866, -0.19509032, -0.20110463, -0.20711138, -0.21311032, -0.21910124, -0.22508391, -0.23105811, -0.23702361, -0.24298018, -0.24892761, -0.25486566, -0.26079412, -0.26671276, -0.27262136, -0.27851969, -0.28440754, -0.29028468, -0.29615089, -0.30200595, -0.30784964, -0.31368174, -0.31950203, -0.32531029, -0.33110631, -0.33688985, -0.34266072, -0.34841868, -0.35416353, -0.35989504, -0.365613, -0.37131719, -0.37700741, -0.38268343, -0.38834505, -0.39399204, -0.3996242, -0.40524131, -0.41084317, -0.41642956, -0.42200027, -0.42755509, -0.43309382, -0.43861624, -0.44412214, -0.44961133, -0.45508359, -0.46053871, -0.4659765, -0.47139674, -0.47679923, -0.48218377, -0.48755016, -0.49289819, -0.49822767, -0.50353838, -0.50883014, -0.51410274, -0.51935599, -0.52458968, -0.52980362, -0.53499762, -0.54017147, -0.54532499, -0.55045797, -0.55557023, -0.56066158, -0.56573181, -0.57078075, -0.57580819, -0.58081396, -0.58579786, -0.5907597, -0.5956993, -0.60061648, -0.60551104, -0.61038281, -0.61523159, -0.62005721, -0.62485949, -0.62963824, -0.63439328, -0.63912444, -0.64383154, -0.6485144, -0.65317284, -0.65780669, -0.66241578, -0.66699992, -0.67155895, -0.6760927, -0.680601, -0.68508367, -0.68954054, -0.69397146, -0.69837625, -0.70275474, -0.70710678, -0.7114322, -0.71573083, -0.72000251, -0.72424708, -0.72846439, -0.73265427, -0.73681657, -0.74095113, -0.74505779, -0.74913639, -0.7531868, -0.75720885, -0.76120239, -0.76516727, -0.76910334, -0.77301045, -0.77688847, -0.78073723, -0.7845566, -0.78834643, -0.79210658, -0.7958369, -0.79953727, -0.80320753, -0.80684755, -0.8104572, -0.81403633, -0.81758481, -0.82110251, -0.8245893, -0.82804505, -0.83146961, -0.83486287, -0.83822471, -0.84155498, -0.84485357, -0.84812034, -0.85135519, -0.85455799, -0.85772861, -0.86086694, -0.86397286, -0.86704625, -0.87008699, -0.87309498, -0.87607009, -0.87901223, -0.88192126, -0.8847971, -0.88763962, -0.89044872, -0.8932243, -0.89596625, -0.89867447, -0.90134885, -0.90398929, -0.9065957, -0.90916798, -0.91170603, -0.91420976, -0.91667906, -0.91911385, -0.92151404, -0.92387953, -0.92621024, -0.92850608, -0.93076696, -0.9329928, -0.93518351, -0.93733901, -0.93945922, -0.94154407, -0.94359346, -0.94560733, -0.94758559, -0.94952818, -0.95143502, -0.95330604, -0.95514117, -0.95694034, -0.95870347, -0.96043052, -0.9621214, -0.96377607, -0.96539444, -0.96697647, -0.96852209, -0.97003125, -0.97150389, -0.97293995, -0.97433938, -0.97570213, -0.97702814, -0.97831737, -0.97956977, -0.98078528, -0.98196387, -0.98310549, -0.98421009, -0.98527764, -0.9863081, -0.98730142, -0.98825757, -0.98917651, -0.99005821, -0.99090264, -0.99170975, -0.99247953, -0.99321195, -0.99390697, -0.99456457, -0.99518473, -0.99576741, -0.99631261, -0.9968203, -0.99729046, -0.99772307, -0.99811811, -0.99847558, -0.99879546, -0.99907773, -0.99932238, -0.99952942, -0.99969882, -0.99983058, -0.9999247, -0.99998118, -1.0, -0.99998118, -0.9999247, -0.99983058, -0.99969882, -0.99952942, -0.99932238, -0.99907773, -0.99879546, -0.99847558, -0.99811811, -0.99772307, -0.99729046, -0.9968203, -0.99631261, -0.99576741, -0.99518473, -0.99456457, -0.99390697, -0.99321195, -0.99247953, -0.99170975, -0.99090264, -0.99005821, -0.98917651, -0.98825757, -0.98730142, -0.9863081, -0.98527764, -0.98421009, -0.98310549, -0.98196387, -0.98078528, -0.97956977, -0.97831737, -0.97702814, -0.97570213, -0.97433938, -0.97293995, -0.97150389, -0.97003125, -0.96852209, -0.96697647, -0.96539444, -0.96377607, -0.9621214, -0.96043052, -0.95870347, -0.95694034, -0.95514117, -0.95330604, -0.95143502, -0.94952818, -0.94758559, -0.94560733, -0.94359346, -0.94154407, -0.93945922, -0.93733901, -0.93518351, -0.9329928, -0.93076696, -0.92850608, -0.92621024, -0.92387953, -0.92151404, -0.91911385, -0.91667906, -0.91420976, -0.91170603, -0.90916798, -0.9065957, -0.90398929, -0.90134885, -0.89867447, -0.89596625, -0.8932243, -0.89044872, -0.88763962, -0.8847971, -0.88192126, -0.87901223, -0.87607009, -0.87309498, -0.87008699, -0.86704625, -0.86397286, -0.86086694, -0.85772861, -0.85455799, -0.85135519, -0.84812034, -0.84485357, -0.84155498, -0.83822471, -0.83486287, -0.83146961, -0.82804505, -0.8245893, -0.82110251, -0.81758481, -0.81403633, -0.8104572, -0.80684755, -0.80320753, -0.79953727, -0.7958369, -0.79210658, -0.78834643, -0.7845566, -0.78073723, -0.77688847, -0.77301045, -0.76910334, -0.76516727, -0.76120239, -0.75720885, -0.7531868, -0.74913639, -0.74505779, -0.74095113, -0.73681657, -0.73265427, -0.72846439, -0.72424708, -0.72000251, -0.71573083, -0.7114322, -0.70710678, -0.70275474, -0.69837625, -0.69397146, -0.68954054, -0.68508367, -0.680601, -0.6760927, -0.67155895, -0.66699992, -0.66241578, -0.65780669, -0.65317284, -0.6485144, -0.64383154, -0.63912444, -0.63439328, -0.62963824, -0.62485949, -0.62005721, -0.61523159, -0.61038281, -0.60551104, -0.60061648, -0.5956993, -0.5907597, -0.58579786, -0.58081396, -0.57580819, -0.57078075, -0.56573181, -0.56066158, -0.55557023, -0.55045797, -0.54532499, -0.54017147, -0.53499762, -0.52980362, -0.52458968, -0.51935599, -0.51410274, -0.50883014, -0.50353838, -0.49822767, -0.49289819, -0.48755016, -0.48218377, -0.47679923, -0.47139674, -0.4659765, -0.46053871, -0.45508359, -0.44961133, -0.44412214, -0.43861624, -0.43309382, -0.42755509, -0.42200027, -0.41642956, -0.41084317, -0.40524131, -0.3996242, -0.39399204, -0.38834505, -0.38268343, -0.37700741, -0.37131719, -0.365613, -0.35989504, -0.35416353, -0.34841868, -0.34266072, -0.33688985, -0.33110631, -0.32531029, -0.31950203, -0.31368174, -0.30784964, -0.30200595, -0.29615089, -0.29028468, -0.28440754, -0.27851969, -0.27262136, -0.26671276, -0.26079412, -0.25486566, -0.24892761, -0.24298018, -0.23702361, -0.23105811, -0.22508391, -0.21910124, -0.21311032, -0.20711138, -0.20110463, -0.19509032, -0.18906866, -0.18303989, -0.17700422, -0.17096189, -0.16491312, -0.15885814, -0.15279719, -0.14673047, -0.14065824, -0.13458071, -0.12849811, -0.12241068, -0.11631863, -0.11022221, -0.10412163, -0.09801714, -0.09190896, -0.08579731, -0.07968244, -0.07356456, -0.06744392, -0.06132074, -0.05519524, -0.04906767, -0.04293826, -0.03680722, -0.0306748, -0.02454123, -0.01840673, -0.01227154, -0.00613588};
static double imag[SIZE];

static const int inds[SIZE] = {0, 512, 256, 768, 128, 640, 384, 896, 64, 576, 320, 832, 192, 704, 448, 960, 32, 544, 288, 800, 160, 672, 416, 928, 96, 608, 352, 864, 224, 736, 480, 992, 16, 528, 272, 784, 144, 656, 400, 912, 80, 592, 336, 848, 208, 720, 464, 976, 48, 560, 304, 816, 176, 688, 432, 944, 112, 624, 368, 880, 240, 752, 496, 1008, 8, 520, 264, 776, 136, 648, 392, 904, 72, 584, 328, 840, 200, 712, 456, 968, 40, 552, 296, 808, 168, 680, 424, 936, 104, 616, 360, 872, 232, 744, 488, 1000, 24, 536, 280, 792, 152, 664, 408, 920, 88, 600, 344, 856, 216, 728, 472, 984, 56, 568, 312, 824, 184, 696, 440, 952, 120, 632, 376, 888, 248, 760, 504, 1016, 4, 516, 260, 772, 132, 644, 388, 900, 68, 580, 324, 836, 196, 708, 452, 964, 36, 548, 292, 804, 164, 676, 420, 932, 100, 612, 356, 868, 228, 740, 484, 996, 20, 532, 276, 788, 148, 660, 404, 916, 84, 596, 340, 852, 212, 724, 468, 980, 52, 564, 308, 820, 180, 692, 436, 948, 116, 628, 372, 884, 244, 756, 500, 1012, 12, 524, 268, 780, 140, 652, 396, 908, 76, 588, 332, 844, 204, 716, 460, 972, 44, 556, 300, 812, 172, 684, 428, 940, 108, 620, 364, 876, 236, 748, 492, 1004, 28, 540, 284, 796, 156, 668, 412, 924, 92, 604, 348, 860, 220, 732, 476, 988, 60, 572, 316, 828, 188, 700, 444, 956, 124, 636, 380, 892, 252, 764, 508, 1020, 2, 514, 258, 770, 130, 642, 386, 898, 66, 578, 322, 834, 194, 706, 450, 962, 34, 546, 290, 802, 162, 674, 418, 930, 98, 610, 354, 866, 226, 738, 482, 994, 18, 530, 274, 786, 146, 658, 402, 914, 82, 594, 338, 850, 210, 722, 466, 978, 50, 562, 306, 818, 178, 690, 434, 946, 114, 626, 370, 882, 242, 754, 498, 1010, 10, 522, 266, 778, 138, 650, 394, 906, 74, 586, 330, 842, 202, 714, 458, 970, 42, 554, 298, 810, 170, 682, 426, 938, 106, 618, 362, 874, 234, 746, 490, 1002, 26, 538, 282, 794, 154, 666, 410, 922, 90, 602, 346, 858, 218, 730, 474, 986, 58, 570, 314, 826, 186, 698, 442, 954, 122, 634, 378, 890, 250, 762, 506, 1018, 6, 518, 262, 774, 134, 646, 390, 902, 70, 582, 326, 838, 198, 710, 454, 966, 38, 550, 294, 806, 166, 678, 422, 934, 102, 614, 358, 870, 230, 742, 486, 998, 22, 534, 278, 790, 150, 662, 406, 918, 86, 598, 342, 854, 214, 726, 470, 982, 54, 566, 310, 822, 182, 694, 438, 950, 118, 630, 374, 886, 246, 758, 502, 1014, 14, 526, 270, 782, 142, 654, 398, 910, 78, 590, 334, 846, 206, 718, 462, 974, 46, 558, 302, 814, 174, 686, 430, 942, 110, 622, 366, 878, 238, 750, 494, 1006, 30, 542, 286, 798, 158, 670, 414, 926, 94, 606, 350, 862, 222, 734, 478, 990, 62, 574, 318, 830, 190, 702, 446, 958, 126, 638, 382, 894, 254, 766, 510, 1022, 1, 513, 257, 769, 129, 641, 385, 897, 65, 577, 321, 833, 193, 705, 449, 961, 33, 545, 289, 801, 161, 673, 417, 929, 97, 609, 353, 865, 225, 737, 481, 993, 17, 529, 273, 785, 145, 657, 401, 913, 81, 593, 337, 849, 209, 721, 465, 977, 49, 561, 305, 817, 177, 689, 433, 945, 113, 625, 369, 881, 241, 753, 497, 1009, 9, 521, 265, 777, 137, 649, 393, 905, 73, 585, 329, 841, 201, 713, 457, 969, 41, 553, 297, 809, 169, 681, 425, 937, 105, 617, 361, 873, 233, 745, 489, 1001, 25, 537, 281, 793, 153, 665, 409, 921, 89, 601, 345, 857, 217, 729, 473, 985, 57, 569, 313, 825, 185, 697, 441, 953, 121, 633, 377, 889, 249, 761, 505, 1017, 5, 517, 261, 773, 133, 645, 389, 901, 69, 581, 325, 837, 197, 709, 453, 965, 37, 549, 293, 805, 165, 677, 421, 933, 101, 613, 357, 869, 229, 741, 485, 997, 21, 533, 277, 789, 149, 661, 405, 917, 85, 597, 341, 853, 213, 725, 469, 981, 53, 565, 309, 821, 181, 693, 437, 949, 117, 629, 373, 885, 245, 757, 501, 1013, 13, 525, 269, 781, 141, 653, 397, 909, 77, 589, 333, 845, 205, 717, 461, 973, 45, 557, 301, 813, 173, 685, 429, 941, 109, 621, 365, 877, 237, 749, 493, 1005, 29, 541, 285, 797, 157, 669, 413, 925, 93, 605, 349, 861, 221, 733, 477, 989, 61, 573, 317, 829, 189, 701, 445, 957, 125, 637, 381, 893, 253, 765, 509, 1021, 3, 515, 259, 771, 131, 643, 387, 899, 67, 579, 323, 835, 195, 707, 451, 963, 35, 547, 291, 803, 163, 675, 419, 931, 99, 611, 355, 867, 227, 739, 483, 995, 19, 531, 275, 787, 147, 659, 403, 915, 83, 595, 339, 851, 211, 723, 467, 979, 51, 563, 307, 819, 179, 691, 435, 947, 115, 627, 371, 883, 243, 755, 499, 1011, 11, 523, 267, 779, 139, 651, 395, 907, 75, 587, 331, 843, 203, 715, 459, 971, 43, 555, 299, 811, 171, 683, 427, 939, 107, 619, 363, 875, 235, 747, 491, 1003, 27, 539, 283, 795, 155, 667, 411, 923, 91, 603, 347, 859, 219, 731, 475, 987, 59, 571, 315, 827, 187, 699, 443, 955, 123, 635, 379, 891, 251, 763, 507, 1019, 7, 519, 263, 775, 135, 647, 391, 903, 71, 583, 327, 839, 199, 711, 455, 967, 39, 551, 295, 807, 167, 679, 423, 935, 103, 615, 359, 871, 231, 743, 487, 999, 23, 535, 279, 791, 151, 663, 407, 919, 87, 599, 343, 855, 215, 727, 471, 983, 55, 567, 311, 823, 183, 695, 439, 951, 119, 631, 375, 887, 247, 759, 503, 1015, 15, 527, 271, 783, 143, 655, 399, 911, 79, 591, 335, 847, 207, 719, 463, 975, 47, 559, 303, 815, 175, 687, 431, 943, 111, 623, 367, 879, 239, 751, 495, 1007, 31, 543, 287, 799, 159, 671, 415, 927, 95, 607, 351, 863, 223, 735, 479, 991, 63, 575, 319, 831, 191, 703, 447, 959, 127, 639, 383, 895, 255, 767, 511, 1023};

int pow_of_two(int exponent)
{
	int ans = 1;
	for (int i = 0; i < exponent; ++i)
	{
		ans *= 2;
	}
	return ans;
}

/* input: real (time) data
 * output: spectra energy (magnitude squared)
 */
// TODO - FIX SHUFFLING
int fftlib_spectra(double * real)
{
	// initialize imaginary to 0
	for (int i = 0; i < SIZE; ++i)
	{
		imag[i] = 0.0;
	}
	for (int stage = 0; stage < BITS; ++stage)
	{
		int half_frame = pow_of_two(stage);
		int frame = 2 * half_frame;
		int rootSpacing = pow_of_two(BITS-1-stage);
		for (int a = 0; a < SIZE; a += frame)
		{
			for (int b = 0; b < half_frame; ++b)
			{
				int left_butterfly_index = a + b;
				int right_butterfly_index = inds[left_butterfly_index + half_frame];
				left_butterfly_index = inds[left_butterfly_index];
				int left_root_index = b * rootSpacing;
				int right_root_index = (b + half_frame) * rootSpacing;
				/* First Half of Butterfly Calculation */
				double real_left = real[left_butterfly_index] + (real[right_butterfly_index] * real_roots[left_root_index]) - (imag[right_butterfly_index] * imag_roots[left_root_index]);
				double imag_left = imag[left_butterfly_index] + (real[right_butterfly_index] * imag_roots[left_root_index]) + (imag[right_butterfly_index] * real_roots[left_root_index]);
				/* Second Half of Butterfly Calculation */
				double real_right = real[left_butterfly_index] + (real[right_butterfly_index] * real_roots[right_root_index]) - (imag[right_butterfly_index] * imag_roots[right_root_index]);
				double imag_right = imag[left_butterfly_index] + (real[right_butterfly_index] * imag_roots[right_root_index]) + (imag[right_butterfly_index] * real_roots[right_root_index]);
				real[left_butterfly_index] = real_left;
				imag[left_butterfly_index] = imag_left;
				real[right_butterfly_index] = real_right;
				imag[right_butterfly_index] = imag_right;
			}
		}
	}
	for (int i = 0; i < SIZE; ++i)
	{
		real[i] *= real[i] * imag[i] * imag[i];
	}
	return 0;
}

